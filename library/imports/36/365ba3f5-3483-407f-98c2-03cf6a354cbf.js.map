{"version":3,"sources":["assets/scripts/Appegg.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport GameData from \"./GameData\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Appegg extends cc.Component {\n  configUrl: string = \"https://api2.bmob.cn/1/classes/List/u8QxFFFS\";\n  apiKey: string = \"89f2d6cc27985334699879bfa8aa9dfd\";\n  restApiKey: string = \"9278a7e3613aefe7ec07e390c2276bf2\";\n\n  @property(cc.Node)\n  changelogView: cc.Node;\n\n  @property(cc.Label)\n  changelogTitleLabel: cc.Label;\n\n  @property(cc.Label)\n  changelogContentLabel: cc.Label;\n\n  @property(cc.Button)\n  privacyButton: cc.Button;\n\n  @property(cc.Button)\n  startButton: cc.Button;\n\n  @property(cc.Button)\n  retryButton: cc.Button;\n\n  @property(cc.Node)\n  errorView: cc.Node;\n\n  @property(cc.Node)\n  webView: cc.Node;\n\n  //static url;\n\n  //static privacyUrl;\n\n  //currentVersion: number = 0;\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad() {\n    this.privacyButton.node.on(\"click\", this.onPrivacyClick, this);\n    this.startButton.node.on(\"click\", this.onStartClick, this);\n    this.retryButton.node.on(\"click\", this.onRetryClick, this);\n  }\n\n  start() {\n   //this.currentVersion = cc.sys.localStorage.getItem(\"version\");\n    this.connect();\n  }\n\n  connect() {\n    this.httpGetAsync(\n      this.configUrl,\n      function (str) {\n        console.log(str);\n        var obj = JSON.parse(str);\n        console.log(obj.url);\n        //obj.url = \"http://sdk.panguhy.com/game/?pgcid=2&gameId=3&sid=b788b530481b40e8a988b189510d26cc&deviceId=7522b6708b88464b70c3bf0c9ee60ea1\";\n        GameData.url= obj.url;\n        GameData.privacyUrl = obj.privacyUrl;\n        console.log(\"当前appType为\" + obj.appType);\n        switch (obj.appType) {\n          case 1:\n            //if (this.currentVersion != obj.version)\n            cc.director.loadScene(\"entry\");\n            break;\n          case 2:\n            cc.director.loadScene(\"web\");\n            break;\n          case 3:\n            break;\n        }\n      },\n      function () {\n        //cc.log(\"连接失败\");\n      }\n    );\n  }\n\n\n\n  httpGetAsync(theUrl, callback, error = null) {\n    var xmlHttp = new XMLHttpRequest();\n    xmlHttp.onerror ==\n      function (e) {\n        console.log(\"网络错误\");\n      };\n    xmlHttp.ontimeout ==\n      function (e) {\n        console.log(\"网络超时\");\n      };\n    xmlHttp.onreadystatechange = function () {\n      if (xmlHttp.readyState == 4 && xmlHttp.status == 200)\n        callback(xmlHttp.responseText);\n      else {\n        error();\n      }\n    };\n\n    xmlHttp.open(\"GET\", theUrl, false); // true 为异步\n    xmlHttp.setRequestHeader(\"X-Bmob-Application-Id\", this.apiKey);\n    xmlHttp.setRequestHeader(\"X-Bmob-REST-API-Key\", this.restApiKey);\n    xmlHttp.send(null);\n  }\n\n  onRetryClick(event) {\n    this.errorView.active = false;\n    this.connect();\n  }\n\n  onPrivacyClick(event) {\n    this.webView.active = true;\n  }\n\n  onStartClick(event) {\n    cc.director.loadScene(\"entry\");\n  }\n  // update (dt) {}\n}\n"]}