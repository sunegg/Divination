{"version":3,"sources":["assets/resources/UIDatePicker/UIDatePicker.js"],"names":["cc","Class","Component","properties","lbYearMonth","Label","ndDays","Node","pfbDay","Prefab","yearText","monthText","dayText","onLoad","initData","updateDate","setDate","date","Date","year","getFullYear","month","getMonth","day","getDate","pfgListDay","i","node","instantiate","parent","push","string","js","formatStr","totalDays","fromWeek","getDay","length","active","index","row","Math","floor","col","x","width","y","height","setPosition","script","getComponent","setDay","selIndex","selDay","onClickLeft","setFullYear","setMonth","onClickRight","setPickDateCallback","cb","onClickClose"],"mappings":"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","sourceRoot":"/","sourcesContent":["/** \n * 日期组件\n */\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        lbYearMonth: cc.Label,\n        ndDays: cc.Node,\n        pfbDay: cc.Prefab,\n         yearText: cc.Label,\n         monthText: cc.Label,\n         dayText: cc.Label,\n    },\n\n    onLoad () {\n        this.initData();\n        this.updateDate();\n        this.setDate(1994,4,29);\n    },\n\n    initData() {\n        this.date = this.date ? this.date : new Date();\n        this.year = this.date.getFullYear();\n        this.month = this.date.getMonth();\n        this.day = this.date.getDate();\n\n        this.pfgListDay = [];\n        for (let i = 0; i < 31; ++i) {\n            let node = cc.instantiate(this.pfbDay);\n            node.parent = this.ndDays;\n            this.pfgListDay.push(node);\n        }\n    },\n\n    // 设置显示的日志，默认为当前日期\n    setDate(year, month, day) {\n        this.date = new Date(year, month, day);\n        this.year = this.date.getFullYear();\n        this.month = this.date.getMonth();\n        this.day = this.date.getDate();\n        this.updateDate();\n    },\n\n    updateDate () {\n        this.lbYearMonth.string = cc.js.formatStr(\"%s年%s月\", this.year, this.month + 1);\n\n        let date = new Date(this.year, this.month, 0);\n        let totalDays = date.getDate();\n        let fromWeek = date.getDay();\n        for (let i = 0; i < this.pfgListDay.length; ++i) {\n            let node = this.pfgListDay[i];\n            if (i < totalDays) {\n                node.active = true;\n                let index = fromWeek + i;\n                let row = Math.floor(index / 7);\n                let col = index % 7;\n                let x = -(this.ndDays.width - node.width) * 0.5 + col * node.width;\n                let y = (this.ndDays.height - node.height) * 0.5 - row * node.height;\n                node.setPosition(x, y);\n                let script = node.getComponent(\"UIItemDay\");\n                script.setDay(i, i + 1, this.day === i + 1, (selIndex, selDay)=>{\n                    this.day = selDay;\n                    this.updateDate();\n                });\n            } else {\n                node.active = false;\n            }\n        }\n        this.yearText.string = this.year;\n        this.monthText.string = this.month+1;\n        this.dayText.string = this.day;\n        //console.log( this.yearText + \".\" +   this.monthText + \".\"+ this.dayText);\n    },\n\n    onClickLeft () {\n        if (this.month > 0) {\n            this.month -= 1;\n        } else {\n            this.month = 11;\n            this.year -= 1;\n        }\n        this.date.setFullYear(this.year);\n        this.date.setMonth(this.month);\n        this.updateDate();\n    },\n\n    onClickRight () {\n        if (this.month < 11) {\n            this.month += 1;\n        } else {\n            this.month = 0;\n            this.year += 1;\n        }\n        this.date.setFullYear(this.year);\n        this.date.setMonth(this.month);\n        this.updateDate();\n    },\n\n    // 设置选中日期之后的回调\n    setPickDateCallback(cb) {\n        this.cb = cb;\n      \n    },\n\n    onClickClose () {\n        if (this.cb) {\n          this.cb(this.year, this.month, this.day);\n        }\n        this.node.parent = null;\n    },\n});\n"]}